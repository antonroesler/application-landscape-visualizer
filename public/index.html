<!--/*
* Copyright (c) 2021 Ecore. All rights reserved.
*
* University:        Frankfurt University of Applied Sciences
* Study program:     Engineering Business Information Systems
* Module:            Advanced Programming 2021
* Professor:         Prof. Dr. Jung, Prof. Dr. Bremm
* Date:              21.04.2021
*
*/

/**
*
* Main page of the web application.
*
* @author Leonard Husske, Patrick Frech
*
*/-->


<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">

<head>
    <meta charset="UTF-8">
    <title>Application Landscape Visualizer</title>

    <link href="css/style.css" rel="stylesheet">
    <!--<link href="css/materialize.css" rel="stylesheet"> -->
    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <!-- Important Google Icon Font -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <script src="libs/gojs-lib/go-debug.js"></script>
    <script src="libs/gojs-lib/Figures.js"></script>
    <script src="libs/gojs-lib/icons.js"></script>
    <script src="libs/url-join.js"></script>
</head>

<body onload="init()">

    <header>
        <div class="main-nav">
            <img class="logo" src="img/logo/ecore_logo.png">
            <div class="search">
                <i id="searchIcon" class="material-icons search-icon hovered" onclick="toggleSearchbar()">search</i>
                <div class="input-search">
                    <input id="searchbar" oninput="searchbarInput()" type="text" placeholder="Search nodes"
                        autocomplete="off">
                </div>
                <i class="material-icons search-icon" onclick="resetSearchInput()">close</i>
            </div>
            <nav>
                <ul class="nav-links">
                    <li><a href="#" onclick="openLayoutModal()">Auto Layout</a></li>
                    <li><a href="#" onclick="loadDiagramNames(); openLoadDiagramModal();">Load</a></li>
                    <li><a href="#" id="saveButton" onclick="openSaveDiagramModal()">Save</a></li>
                    <li><a href="#" onclick="openExportModal()">Export</a></li>
                </ul>
            </nav>
            <a class="cta" href="#" onclick="window.location.reload()"><button class="nav-btn">Create
                    Diagram</button></a>
        </div>
        <div class="sub-nav">
            <nav>
                <ul class="nav-links">
                    <li><a href="#" onclick="openCreateNodeModal();">Create Node</a></li>
                    <li><a href="#" onclick="deleteNode()">Delete Node</a></li>
                    <li><a href="#" onclick="diagram.commandHandler.undo()">Undo</a></li>
                    <li><a href="#" onclick="diagram.commandHandler.redo()">Redo</a></li>
                    <li><a href="#" data-target="slide-out" class="" onclick="openSidenav()">Add Filter</a></li>
                </ul>
            </nav>
        </div>
    </header>


    <!-- Create Node Modal -->
    <div class="modal-bg" id="createNodeModal">
        <div class="modal-popup">
            <div class="modal-close" onclick="deleteDropdownMenuOptions(); closeModal();">+</div>
            <div class="modal-content">
                <h2>Create new Node.</h2>
                <form class="modal-form" action="" onsubmit="return false">
                    <input type="hidden" id="contextMenu" />
                    <input autocomplete="off" class="input-text" id="inputName" placeholder="Node Name: " type="text" />
                    <textarea autocomplete="off" class="input-text input-textarea" id="inputDescription"
                        placeholder="Description: " type="text"></textarea>
                    <div class="form-row">
                        <input list="inputLicenceDropdown" autocomplete="off" class="input-text" id="inputLicense"
                            placeholder="License: " type="text" />
                        <datalist id="inputLicenceDropdown"></datalist>
                        <input list="inputVersionDropdown" autocomplete="off" class="input-text" id="inputVersion"
                            placeholder="Version: " type="text" />
                        <datalist id="inputVersionDropdown"></datalist>
                    </div>
                    <span class="dropdown-description">Departments:</span>
                    <div id="inputDepartments" class="chips"></div>
                    <datalist id="inputDepartmentsDropdown"></datalist>
                    <span class="dropdown-description">Tags:</span>
                    <div id="inputTags" class="chips"></div>
                    <datalist id="inputTagsDropdown"></datalist>
                    <div class="form-row">
                        <span class="dropdown-description"> Start Date:</span>
                        <span class="dropdown-description"> Shutdown Date:</span>
                    </div>
                    <div class="form-row">
                        <input type="date" id="inputStartDate" class="input-text">
                        <input type="date" id="inputShutdownDate" class="input-text">
                    </div>
                    <div class="form-row">
                        <input list="inputProfessionalOwnerDropdown" autocomplete="off" class="input-text"
                            id="inputProfessionalOwner" placeholder="Prof. Owner: " type="text" />
                        <datalist id="inputProfessionalOwnerDropdown"></datalist>
                        <input list="inputTechnicalOwnerDropdown" autocomplete="off" class="input-text"
                            id="inputTechnicalOwner" placeholder="Tech. Owner: " type="text" />
                        <datalist id="inputTechnicalOwnerDropdown"></datalist>
                    </div>
                    <span class="dropdown-description">Application Type:</span>
                    <select class="input-dropdown" id="inputCategory" placeholder="Application Type: " type="text">
                        <option value="BI">BI</option>
                        <option value="CRM">CRM</option>
                        <option value="EMS">EMS</option>
                        <option value="ERP">ERP</option>
                        <option value="GEN">GEN</option>
                    </select>
                    <button class="modal-btn"
                        onclick="deleteDropdownMenuOptions(); addAppNode(); closeModal();">Create</button>
                    <button class="modal-btn-cancel"
                        onclick="deleteDropdownMenuOptions(); closeModal();">Cancel</button>
                </form>
            </div>
        </div>
    </div>


    <!-- Layout Modal -->
    <div class="modal-bg" id="layoutModal">
        <div class="modal-popup">
            <div class="modal-close" onclick="closeModal()">+</div>
            <div class="modal-content">
                <h2>Choose Layout.</h2>
                <form class="modal-form" action="" onsubmit="return false">
                    <select class="input-dropdown" id="layoutOptions">
                        <option value="tree">Tree</option>
                        <option value="forcedir">Force Directed</option>
                        <option value="laydi">Layered Digraph</option>
                        <option value="grid">Grid</option>
                        <option value="cir">Circle</option>
                    </select>
                    <button class="modal-btn" onclick="layoutModalDialogHandler(); closeModal();">Add</button>
                    <button class="modal-btn-cancel" onclick="closeModal()">Cancel</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Export Modal -->
    <div class="modal-bg" id="exportModal">
        <div class="modal-popup">
            <div class="modal-close" onclick="closeModal()">+</div>
            <div class="modal-content">
                <h2>Export Diagram.</h2>
                <form class="modal-form" action="" onsubmit="return false">
                    <div>
                        <input type="checkbox" id="exp-png" name="exp-png">
                        <label for="exp-png">PNG with transparent Background</label>
                    </div>
                    <div>
                        <input type="checkbox" id="exp-png-white" name="exp-png-white">
                        <label for="exp-png-white">PNG with white Background</label>
                    </div>
                    <div>
                        <input type="checkbox" id="exp-svg" name="exp-svg">
                        <label for="exp-svg">SVG</label>
                    </div>
                    <input class="input-text" type="text" placeholder="File Name... (optional)" id="exp-name">
                    <button class="modal-btn" onclick="exportDiagram(); closeModal();">Download</button>
                    <button class="modal-btn-cancel" onclick="closeModal()">Cancel</button>
                </form>
            </div>
        </div>
    </div>


    <!-- Load Diagram Modal -->
    <div class="modal-bg" id="loadDiagramModal">
        <div class="modal-popup">
            <div class="modal-close" onclick="closeModal()">+</div>
            <div class="modal-content">
                <h2>Load your Diagram.</h2>
                <form class="modal-form" action="" onsubmit="return false">
                    <select class="input-dropdown" id="loadCategory"></select>
                    <button class="modal-btn" onclick="loadDiagram(); closeModal();">Load</button>
                    <button class="modal-btn-cancel" onclick="closeModal()">Cancel</button>
                </form>
            </div>
        </div>
    </div>


    <!-- Save Diagram Modal -->
    <div class="modal-bg" id="saveDiagramModal">
        <div class="modal-popup">
            <div class="modal-close" onclick="closeModal()">+</div>

            <div class="modal-content">
                <h2>Save your Diagram.</h2>
                <form class="modal-form" action="" onsubmit="return false">
                    <input autocomplete="off" class="input-text" type="text" id="saveName" placeholder="Name">
                    <input autocomplete="off" class="input-text" type="text" id="saveDesc" placeholder="Description">
                    <button class="modal-btn" onclick="saveDiagram(); closeModal();">Save</button>
                    <button class="modal-btn-cancel" onclick="closeModal()">Cancel</button>
                </form>
            </div>

        </div>
    </div>

    <div class="main-content">

        <!-- Slide Menu -->
        <ul id="slide-out" class="sidenav">
            <div class="sidenav-box">
                <h2>Filter<i class="material-icons material-icons-small tooltipped" data-position="right"
                        data-tooltip="<img style='height: 48px' src='img/icons/outer_join.png'><br>The filter behaves like a <b>full outer join</b> in SQL.<br> It returns all nodes which have a matching<br>value in one of the selected checkboxes.">info_outline</i>
                </h2>
                <form id="sidenavForm" class="sidenav-form" action="" onsubmit="return false">
                    <input autocomplete="off" class="input-text sidenav-margin" id="filterName"
                        placeholder="Filter Name: " type="text" />
                    <hr class="hr-collapse">
                    <li class="no-padding">
                        <ul id="collapsible" class="collapsible">
                        </ul>
                    </li>
                    <button class="modal-btn sidenav-margin margin-top"
                        onclick="filterDiagramFromSidenav(); openSidenav();">Add</button>
                    <button class="modal-btn-cancel sidenav-margin" onclick="openSidenav()">Cancel</button>
                </form>
            </div>
        </ul>
        <div id="diagramDiv"></div>

        <!-- Sidebar Right -->
        <div class="sidebar-right">

            <!-- Upper 50% of sidebar -->
            <div class="sidebar-box-resizable">
                <h2>Node Information</h2>
                <div id="nodeInfoContainer" class="node-info-container">
                </div>
            </div>
            <!-- Lower 50% of sidebar -->
            <div class="sidebar-box">
                <hr>
                <div class="row">
                    <div class="col s12 tabbar">
                        <ul class="tabs">
                            <li class="tab col s3"><a href="#filterTab">Filter</a></li>
                            <li class="tab col s3"><a href="#visualizationTab">Visualize</a></li>
                        </ul>
                    </div>
                    <div id="filterTab" class="col s12">
                        <div class="custom-tab">
                            <ul id="filterCollection" class="collection">
                                <li id="zeroFilterElement" class="collection-item" onclick="openSidenav()">
                                    <div>Add filter
                                        <i class="material-icons left">add_circle_outline</i>
                                        <a href="" class="secondary-content">
                                            <i class="material-icons tooltipped" data-position="left" onclick="return false"
                                                data-tooltip="<img style='height: 48px' src='img/icons/inner_join.png'><br>The filter behaves like an <b>inner join</b> in SQL.<br> Nodes that have matching values in<br>all active filters are returned.">info_outline</i>
                                        </a>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div id="visualizationTab" class="col s12">
                        <div class="custom-tab">
                            <select name="color-attribute" id="color-attribute" style="color: black">
                                <option value="category">App. Type</option>
                                <option value="license">License</option>
                                <option value="version">Version</option>
                                <option value="name">Name</option>
                                <option value="profOwner">Prof. Owner</option>
                                <option value="techOwner">Tech. Owner</option>
                                <option value="tags">Tag</option>
                                <option value="departments">Department</option>
                            </select>
                            <button id="apply-color" onclick="applyUserColorSetting()"
                                style="background-color: rgba(20, 124, 229, 1); border:0; outline: 0; border-radius: 1rem; padding: 0.2rem;">Apply
                                Color</button>
                            <button id="remove-color" onclick="removeColorFromAllNodes()"
                                style="background-color: rgba(20, 124, 229, 1); border:0; outline: 0; border-radius: 1rem; padding: 0.2rem;">Remove
                                Color</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <footer>
        <div class="footer-content">
            <p> Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt </p>
        </div>
        <div class="footer-copyright">
            <p> Copyright © 2021 ECORE. All rights reserved. </p>
        </div>
    </footer>

</body>

<script src="libs/materialize.js"></script>
<script src="js/index.js"></script>
<script src="js/diagramListener.js"></script>
<script src="js/materializeElements.js"></script>
<script src="js/sidenav.js"></script>
<script src="js/modal_util.js"></script>
<script src="js/database_util.js"></script>
<script src="js/diagram.js"></script>
<script src="js/contextmenu.js"></script>
<script src="js/filter.js"></script>
<script src="js/layout.js"></script>
<script src="js/highlight.js"></script>
<script src="js/static_util.js"></script>
<script src="js/sidebar.js"></script>
<script src="js/searchbar.js"></script>
<script src="js/exportImg.js"></script>
<script src="js/node_template.js"></script>
<script src="js/link_template.js"></script>
<script src="js/colorNodesSetting.js"></script>
<script src="js/visualisation.js"></script>

</html>